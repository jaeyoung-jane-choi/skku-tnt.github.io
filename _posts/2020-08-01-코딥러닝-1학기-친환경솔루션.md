---
layout: post
title: "[공모전] 2020_1학기 Co-Deep Learning 인공지능을 활용한 친환경 솔루션 : 단체급식소 식수 예측"
tags: [competition]
excerpt_separator: <!--more-->
---

- **프로젝트 설명**: 인공지능을 활용한 친환경 솔루션 : 단체급식소 식수 예측
<!--more-->
- **공모전 일자**: 2020.05 ~ 2020.07
- **주관**: 성균관대학교 대학혁신과공유센터
- **수상실적**: TBD

# 인공지능을 활용한 친환경 솔루션 : 단체급식소 식수 예측

## 실무 프로젝트(스타트업 NUVI LAB 실무과제 수행) 

### 프로젝트 배경 및 목적
- S시청 단체급식소 잔반 및 잔식에 대한 환경문제 심각(잔반 : 배식을 받고 남기는 것, 잔식 : 배식을 하고 남은 것)
- 실제로 S시청 1년 120,000L의 잔반이 발생하고 있으며, 하루에 500L정도의 음식물 쓰레기 발생(환경문제)
- 식수조절 실패로 배식을 못하는 상황도 발생(급식사고)
- 기존의 방법 영양사 및 조리사의 직관으로 식수를 예측하고 있지만, 약 100명 내외의 오차 발생(S시청 평균 이용인원 : 1200명 내외)
- 그래서 문제를 해결하기 위해 데이터 중심의 방법론으로 객관적이면서 정확도 높은 식수인원 산출하는 것이 목적이다

### 전처리 및 탐색적 분석
- 기존의 EXCEL파일로 작업을 수행하던 S시청 식단파일을 분석에 맞게 전처리 작업 수행
- 식수에 영향을 주는 원인 탐색
- 내, 외부 변수 수집(내부 : S시청 이벤트, 출근인원 / 외부 : 날씨(강수, 온도, 미세먼지 등)


제공받은 RAW데이터에 대한 전처리를 수행하고 1차적으로 메뉴 및 요일에 대한 변수를 바탕으로 탐색적 자료분석을 하였다. 탐색적 자료분석을 했을때 메뉴에 대한 영향력보다 요일에 대한 영향력이 크다는 것을 알 수 있었다. 왜냐하면 메뉴에 상관없이 월요일에서 금요일로 갈수록 식수인원이 점차 감소하는 패턴이 있기 때문이다.


<img src="/assets/img/2020-1-codeep/kms/식수.png">



#### 요일별 식수 트렌드(2017 ~ 2019)



<img src="/assets/img/2020-1-codeep/kms/평균.png">



#### 요일별 평균식수(2017 ~ 2019)




위에 보이는 그래프와 같이 요일에 대한 영향이 크며, 메뉴의 종류와 상관없이 일정하게 식수 패턴이 보이는 것을 확인할 수 있었다. 이외에도 다른 요인들을 찾기 위해 내부변수로 S시청의 이벤트 외부변수로 날씨와 같은 변수를 수집하여 분석했지만, 영향력은 거의 없는 것으로 확인 되었다.




### 모델 구축
- 시간의 흐름에 따라 패턴이 있는 것으로 확인
- 일반적인 머신러닝, 딥러닝 모델보다 시계열 모델이 적합하다고 판단
- 시계열관련 알고리즘을 탐색한 결과 이동평균, 가중평균, ARIMA와 같은 전통적인 시계열보다 2017년 페이스북에서 개발한 'Prophet'더 성능적으로 효과적일 것이라고 판단하여 학습 알고리즘을 선택
- 'Prophet'은 학습 및 예측값에 대한 상, 하한선을 설정할 수 있으며 모델이 자체적으로 Change point(반환점)을 잡아 시간에 따른 변화를 감지하고 학습하고, '푸리에 합'을 활용하여 계절성에 대한 요소도 잡을 수가 있다. 이외에도 이벤트에 변수도 추가할 수 있다.


<img src="/assets/img/2020-1-codeep/kms/학습6.png">

#### 학습 및 검증과정


예측모델을 만들기 위해 3개년의 데이터를 활용하여 모델을 학습하였다. 일반화 성능을 높이기 위해 점차 학습데이터를 늘리며 3가지 학습모델을 실험하였다. 이러한 과정에서 주요 하이퍼파라미터를 최대한 많은 값을 입력하여 자동적으로 최적의 값을 찾기 위한 함수를 만들어 검증을 실행하였다.

<img src="/assets/img/2020-1-codeep/kms/결과.png">

#### 검증결과
검증에 활용된 지표는 Mean Absolute Percentage Error)을 활용했으며, 평균 오차 7.5%를 보였다. 이러한 결과는 기존 사람이 예측하는 결과에 비해 약 8% 감소한 결과이다.



### 결론 및 한계

모델을 구축했을 때 일반화 성능이 있는 모델이 완성되었다. 이러한 모델은 기존의 사람의 직관으로 예측할 때 보다 평균적으로 30인분 더 절약하는 효과를 볼 수 있다. 데이터 중심을 통해 산출되는 결과를 활용할 경우 금전적으로 하루 100,500원(1인분 : 3500원) 절감효과가 있으며 지속적으로 한 달 2,100,000원 1년 25,200,000원의 효과를 기대할 수 있다.   
하지만 2020년 '코로나'이슈로 S시청의 급식소가 부분적으로 운영되지 않거나, 재택근무 등으로 전체인원에 큰 변동이 생겨 모델의 예측성능이 검증에 비해 성능이 낮아졌다. 특수한 케이스로 인해 모델에 대한 예측력이 떨어지는 경향을 보였다.
비록 특수한 케이스로 일반화 성능이 조금 떨어졌지만, 기존에 사람의 직관으로 예측하여 큰 문제가 있었던 부분을 데이터 중심의 모델을 통해 개선할 수 있는 것을 볼 수 있었다. 모델을 더 고도화하고, 특수한 상황에서 사람의 판단을 통해 현재 발생하고 있는 환경문제를 지금보다 더 개선하여 데이터 중심의 모델이 전국에 있는 단체급식소에 새로운 친환경 솔루션이 될 것을 기대한다 